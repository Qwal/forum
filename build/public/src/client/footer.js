"use strict";define("forum/footer",["notifications","chat","components","translator"],function(a,t,n,e){a.prepareDOM();t.prepareDOM();e.prepareDOM();function r(t,n){if(!utils.isNumber(n)){return}$('a[href="'+config.relative_path+t+'"].navigation-link i').toggleClass("unread-count",n>0).attr("data-content",n>99?"99+":n)}function i(t){n.get("chat/icon").toggleClass("unread-count",t>0).attr("data-content",t>99?"99+":t)}function o(){var e={};function t(t){if(t&&t.posts&&t.posts.length){var n=t.posts[0];if(parseInt(n.uid,10)!==parseInt(app.user.uid,10)&&!e[n.topic.tid]){a(t);i(n.topic.tid);e[n.topic.tid]=true}}}function a(t){var n=t.posts[0];var a=parseInt($('a[href="'+config.relative_path+'/unread"].navigation-link i').attr("data-content"),10)+1;r("/unread",a);var e=n.isMain&&parseInt(n.uid,10)!==parseInt(app.user.uid,10);if(e){var i=parseInt($('a[href="'+config.relative_path+'/unread/new"].navigation-link i').attr("data-content"),10)+1;r("/unread/new",i)}socket.emit("topics.isFollowed",n.topic.tid,function(t,n){if(t){return app.alertError(t.message)}if(n){var a=parseInt($('a[href="'+config.relative_path+'/unread/watched"].navigation-link i').attr("data-content"),10)+1;r("/unread/watched",a)}})}function i(t){$('[data-tid="'+t+'"]').addClass("unread")}$(window).on("action:ajaxify.end",function(t,n){if(n.url){var a=n.url.match(/^topic\/(\d+)/);if(a&&a[1]){delete e[a[1]]}}});socket.on("event:new_post",t)}if(app.user.uid){socket.emit("user.getUnreadCounts",function(t,n){if(t){return app.alert(t.message)}u(n);i(n.unreadChatCount);a.updateNotifCount(n.unreadNotificationCount)})}function u(t){r("/unread",t.unreadTopicCount);r("/unread/new",t.unreadNewTopicCount);r("/unread/watched",t.unreadWatchedTopicCount)}socket.on("event:unread.updateCount",u);socket.on("event:unread.updateChatCount",i);o()});
//# sourceMappingURL=public/src/client/footer.js.map