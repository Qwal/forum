"use strict";define("forum/unread",["forum/recent","topicSelect","forum/infinitescroll","components"],function(o,a,e,n){var t={};$(window).on("action:ajaxify.start",function(t,e){if(ajaxify.currentPage!==e.url){o.removeListeners()}});t.init=function(){app.enterRoom("unread_topics");$("#new-topics-alert").on("click",function(){$(this).addClass("hide")});o.watchForNewPosts();o.handleCategorySelection();$(window).trigger("action:topics.loaded",{topics:ajaxify.data.topics});$("#markSelectedRead").on("click",function(){var e=a.getSelectedTids();if(!e.length){return}socket.emit("topics.markAsRead",e,function(t){if(t){return app.alertError(t.message)}i(e)})});$("#markAllRead").on("click",function(){socket.emit("topics.markAllRead",function(t){if(t){return app.alertError(t.message)}app.alertSuccess("[[unread:topics_marked_as_read.success]]");$('[component="category"]').empty();$('[component="pagination"]').addClass("hidden");$("#category-no-topics").removeClass("hidden");$(".markread").addClass("hidden")})});$(".markread").on("click",".category",function(){function t(t){var e=[];n.get("category/topic","cid",t).each(function(){e.push($(this).attr("data-tid"))});return e}var e=$(this).attr("data-cid");var o=t(e);socket.emit("topics.markCategoryTopicsRead",e,function(t){if(t){return app.alertError(t.message)}i(o)})});a.init();if($("body").height()<=$(window).height()&&$('[component="category"]').children().length>=20){$("#load-more-btn").show()}$("#load-more-btn").on("click",function(){t()});if(!config.usePagination){e.init(t)}function t(t){if(t<0||!$('[component="category"]').length){return}e.loadMore("topics.loadMoreUnreadTopics",{after:$('[component="category"]').attr("data-nextstart"),count:config.topicsPerPage,cid:utils.params().cid,filter:ajaxify.data.selectedFilter.filter},function(t,e){if(t.topics&&t.topics.length){o.onTopicsLoaded("unread",t.topics,true,e);$('[component="category"]').attr("data-nextstart",t.nextStart)}else{e();$("#load-more-btn").hide()}})}};function i(t){r(t);app.alertSuccess("[[unread:topics_marked_as_read.success]]");if(!$('[component="category"]').children().length){$("#category-no-topics").removeClass("hidden");$(".markread").addClass("hidden")}}function r(t){for(var e=0;e<t.length;e+=1){n.get("category/topic","tid",t[e]).remove()}}return t});
//# sourceMappingURL=public/src/client/unread.js.map