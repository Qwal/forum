"use strict";define("forum/account/settings",["forum/account/header","components","sounds"],function(t,e,o){var a={};$(window).on("action:ajaxify.start",function(){if(ajaxify.data.template.name==="account/settings"&&$("#bootswatchSkin").val()!==config.bootswatchSkin){n(config.bootswatchSkin)}});a.init=function(){t.init();$("#submitBtn").on("click",function(){var t=i();if(t.homePageRoute==="custom"&&t.homePageCustom){$.get(config.relative_path+"/"+t.homePageCustom,function(){s(t)}).fail(function(){app.alertError("[[error:invalid-home-page-route]]")})}else{s(t)}return false});$("#bootswatchSkin").on("change",function(){n($(this).val())});$('[data-property="homePageRoute"]').on("change",r);$(".account").find('button[data-action="play"]').on("click",function(t){t.preventDefault();var e=$(this).parent().parent().find("select").val();o.playSound(e)});r();e.get("user/sessions").find(".timeago").timeago()};function n(t){var e=$("#bootswatchCSS");if(t==="noskin"||t==="default"&&config.defaultBootswatchSkin==="noskin"){e.remove()}else{if(t==="default"){t=config.defaultBootswatchSkin}var a="//maxcdn.bootstrapcdn.com/bootswatch/3.3.7/"+t+"/bootstrap.min.css";if(e.length){e.attr("href",a)}else{e=$('<link id="bootswatchCSS" href="'+a+'" rel="stylesheet" media="screen">');$("head").append(e)}}var n=$("body").attr("class").split(/\s+/).filter(function(t){return t.startsWith("skin-")});$("body").removeClass(n.join(" ")).addClass("skin-"+t)}function i(){var n={};$(".account").find("input, textarea, select").each(function(t,e){e=$(e);var a=e.attr("data-property");if(e.is("select")){n[a]=e.val();return}switch(e.attr("type")){case"text":case"textarea":n[a]=e.val();break;case"checkbox":n[a]=e.is(":checked")?1:0;break}});return n}function s(t){socket.emit("user.saveSettings",{uid:ajaxify.data.theirid,settings:t},function(t,e){if(t){return app.alertError(t.message)}app.alertSuccess("[[success:settings-saved]]");var a=false;for(var n in e){if(e.hasOwnProperty(n)){if(n==="userLang"&&config.userLang!==e.userLang){a=true}if(config.hasOwnProperty(n)){config[n]=e[n]}}}o.loadMap();if(a&&parseInt(app.user.uid,10)===parseInt(ajaxify.data.theirid,10)){app.alert({id:"setting-change",message:"[[user:settings-require-reload]]",type:"warning",timeout:5e3,clickfn:function(){ajaxify.refresh()}})}})}function r(){if($('[data-property="homePageRoute"]').val()==="custom"){$("#homePageCustom").show()}else{$("#homePageCustom").hide();$('[data-property="homePageCustom"]').val("")}}return a});
//# sourceMappingURL=public/src/client/account/settings.js.map