"use strict";define("composer/categoryList",["categorySelector"],function(s){var e={};e.init=function(c,a){var o=c.find(".category-list-container");if(!o.length){return}c.on("action:composer.resize",function(){l(c)});socket.emit("categories.getCategoriesByPrivilege","topics:create",function(e,t){if(e){return app.alertError(e.message)}var r=[];t=t.filter(function(e){return e&&!e.link});var n={};t.forEach(function(e){e.children=[];n[e.cid]=e});t.forEach(function(e){if(e.parent){var t=e.parent.cid;if(!n[t]){n[t]=e.parent;n[t].disabledClass=true}n[t].children=n[t].children||[];n[t].children.push(e)}});var i=[];Object.keys(n).forEach(function(e){if(!n[e].parent){i.push(n[e])}});i=i.sort(function(e,t){return e.order-t.order});i.forEach(function(e){f(e,r,"")});app.parseAndTranslate("partials/category-selector",{categories:r,pullRight:true},function(e){o.append(e);s.init(o.find('[component="category-selector"]'),function(e){if(a.hasOwnProperty("cid")){d(c,a,e.cid)}$("[tabindex="+(parseInt($(this).attr("tabindex"),10)+1)+"]").trigger("focus")});if(a.cid){s.selectCategory(a.cid)}var t=s.getSelectedCategory();$(".category-name").translateText(t?t.name:"[[modules:composer.select_category]]");$(".category-selector").find('li[data-cid="'+a.cid+'"]').addClass("active");l(c)})});$(".category-selector").on("click","li",function(){$(".category-name").text($(this).text());$(".category-selector").removeClass("open");$(".category-selector li").removeClass("active");$(this).addClass("active");var e=$(this).attr("data-cid");s.selectCategory(e);if(a.hasOwnProperty("cid")){d(c,a,e)}})};function l(e){e.find('.category-list-container [component="category-selector"]').toggleClass("dropup",e.outerHeight()<$(window).height()/2)}e.getSelectedCid=function(){var e=s.getSelectedCategory();return e?e.cid:0};function d(t,r,n){r.cid=n;require(["composer/tags"],function(e){e.onChangeCategory(t,r,n)})}function f(e,t,r){if(e.link){return}var n=r?"&bull; ":"";e.value=e.cid;e.level=r;e.text=r+n+e.name;t.push(e);$('<li data-cid="'+e.cid+'">'+e.name+"</li>").translateText(e.name).appendTo($(".category-selector"));e.children.forEach(function(e){f(e,t,"&nbsp;&nbsp;&nbsp;&nbsp;"+r)})}return e});
//# sourceMappingURL=node_modules/nodebb-plugin-composer-default/static/lib/composer/categoryList.js.map