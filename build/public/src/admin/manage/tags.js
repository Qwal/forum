"use strict";define("admin/manage/tags",["forum/infinitescroll","admin/modules/selectable","admin/modules/colorpicker"],function(a,t,n){var e={};var r=0;e.init=function(){t.enable(".tag-management",".tag-row");i();o();c();s();l()};function i(){var e=$("#create-modal");var t=$("#create-tag-name");var n=$("#create-modal-go");e.on("keypress",function(a){if(a.keyCode===13){n.click()}});$("#create").on("click",function(){e.modal("show");setTimeout(function(){t.focus()},250)});n.on("click",function(){socket.emit("admin.tags.create",{tag:t.val()},function(a){if(a){return app.alertError(a.message)}t.val("");e.on("hidden.bs.modal",function(){ajaxify.refresh()});e.modal("hide")})})}function o(){$("#tag-search").on("input propertychange",function(){if(r){clearTimeout(r);r=0}r=setTimeout(function(){socket.emit("topics.searchAndLoadTags",{query:$("#tag-search").val()},function(a,e){if(a){return app.alertError(a.message)}app.parseAndTranslate("admin/manage/tags","tags",{tags:e.tags},function(a){$(".tag-list").html(a);utils.makeNumbersHumanReadable(a.find(".human-readable-number"));r=0;t.enable(".tag-management",".tag-row")})})},100)})}function c(){$("#modify").on("click",function(){var a=$(".tag-row.ui-selected");if(!a.length){return}var e=$(a[0]);var t=a.length>1?"[[admin/manage/tags:alerts.editing-multiple]]":"[[admin/manage/tags:alerts.editing-x, "+e.find(".tag-item").attr("data-tag")+"]]";var n=bootbox.dialog({title:t,message:e.find(".tag-modal").html(),buttons:{success:{label:"Save",className:"btn-primary save",callback:function(){var t=$(".bootbox");var n=t.find('[data-name="bgColor"]').val();var r=t.find('[data-name="color"]').val();var i=[];a.each(function(a,e){e=$(e);i.push({value:e.attr("data-tag"),color:t.find('[data-name="color"]').val(),bgColor:t.find('[data-name="bgColor"]').val()});e.find('[data-name="bgColor"]').val(n);e.find('[data-name="color"]').val(r);e.find(".tag-item").css("background-color",n).css("color",r)});socket.emit("admin.tags.update",i,function(a){if(a){return app.alertError(a.message)}app.alertSuccess("[[admin/manage/tags:alerts.update-success]]")})}}}});m(n)})}function s(){$("#rename").on("click",function(){var a=$(".tag-row.ui-selected");if(!a.length){return}var e=$(a[0]);var t=a.length>1?"[[admin/manage/tags:alerts.editing-multiple]]":"[[admin/manage/tags:alerts.editing-x, "+e.find(".tag-item").attr("data-tag")+"]]";var n=bootbox.dialog({title:t,message:$(".rename-modal").html(),buttons:{success:{label:"Save",className:"btn-primary save",callback:function(){var t=[];a.each(function(a,e){e=$(e);t.push({value:e.attr("data-tag"),newName:n.find('[data-name="value"]').val()})});socket.emit("admin.tags.rename",t,function(a){if(a){return app.alertError(a.message)}app.alertSuccess("[[admin/manage/tags:alerts.update-success]]")})}}}})})}function l(){$("#deleteSelected").on("click",function(){var e=$(".tag-row.ui-selected");if(!e.length){return}bootbox.confirm("[[admin/manage/tags:alerts.confirm-delete]]",function(a){if(!a){return}var t=[];e.each(function(a,e){t.push($(e).attr("data-tag"))});socket.emit("admin.tags.deleteTags",{tags:t},function(a){if(a){return app.alertError(a.message)}e.remove()})})})}function m(a){function e(a,e){var t=$(e);n.enable(t)}a.find('[data-name="bgColor"], [data-name="color"]').each(e)}return e});
//# sourceMappingURL=public/src/admin/manage/tags.js.map