"use strict";define("admin/settings/email",["ace/ace","admin/settings"],function(e){var t={};var a;t.init=function(){i();n();r();s();$(window).on("action:admin.settingsLoaded action:admin.settingsSaved",r);$(window).on("action:admin.settingsSaved",function(){socket.emit("admin.user.restartJobs")});$('[id="email:smtpTransport:service"]').change(s)};function i(){$('button[data-action="email.test"]').off("click").on("click",function(){socket.emit("admin.email.test",{template:$("#test-email").val()},function(e){if(e){return app.alertError(e.message)}app.alertSuccess("Test Email Sent")});return false})}function n(){$("#email-editor-selector").on("change",o);a=e.edit("email-editor");a.$blockScrolling=Infinity;a.setTheme("ace/theme/twilight");a.getSession().setMode("ace/mode/html");a.on("change",function(){var t=$("#email-editor-selector").val();var i;ajaxify.data.emails.forEach(function(e){if(e.path===t){i=e.original}});var e=a.getValue();$("#email-editor-holder").val(e!==i?e:"")});$('button[data-action="email.revert"]').off("click").on("click",function(){ajaxify.data.emails.forEach(function(e){if(e.path===$("#email-editor-selector").val()){a.getSession().setValue(e.original);$("#email-editor-holder").val("")}})});o()}function o(){ajaxify.data.emails.forEach(function(e){if(e.path===$("#email-editor-selector").val()){a.getSession().setValue(e.text);$("#email-editor-holder").val(e.text!==e.original?e.text:"").attr("data-field","email:custom:"+e.path)}})}function r(){var i=parseInt($("#digestHour").val(),10);if(isNaN(i)){i=17}else if(i>23||i<0){i=0}socket.emit("meta.getServerTime",{},function(e,t){if(e){return app.alertError(e.message)}t=new Date(t);$("#serverTime").text(t.toString());t.setHours(parseInt(i,10),0,0,0);if(t.getTime()<Date.now()){t.setDate(t.getDate()+1)}$("#nextDigestTime").text(t.toString())})}function s(){var e=$('[id="email:smtpTransport:service"]').val()==="nodebb-custom-smtp";$('[id="email:smtpTransport:custom-service"]')[e?"slideDown":"slideUp"](e)}return t});
//# sourceMappingURL=public/src/admin/settings/email.js.map